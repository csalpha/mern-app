{"ast":null,"code":"import _toConsumableArray from\"/home/carlos/Documents/GitHub/mern-ecommerce/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/carlos/Documents/GitHub/mern-ecommerce/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from'react';import socketIOClient from'socket.io-client';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import Card from'react-bootstrap/Card';import Button from'react-bootstrap/Button';import InputGroup from'react-bootstrap/InputGroup';import FormControl from'react-bootstrap/FormControl';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ENDPOINT=window.location.host.indexOf('localhost')>=0?'http://127.0.0.1:5000':window.location.host;export default function ChatBox(props){var userInfo=props.userInfo;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),socket=_useState2[0],setSocket=_useState2[1];var uiMessagesRef=useRef(null);var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isOpen=_useState4[0],setIsOpen=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),messageBody=_useState6[0],setMessageBody=_useState6[1];var _useState7=useState([{name:'Admin',body:'Hello there, Please ask your question.'}]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];useEffect(function(){if(uiMessagesRef.current){uiMessagesRef.current.scrollBy({top:uiMessagesRef.current.clientHeight,left:0,behavior:'smooth'});}if(socket){socket.emit('onLogin',{_id:userInfo._id,name:userInfo.name,isAdmin:userInfo.isAdmin});socket.on('message',function(data){setMessages([].concat(_toConsumableArray(messages),[{body:data.body,name:data.name}]));});}},[messages,isOpen,socket,userInfo]);var supportHandler=function supportHandler(){setIsOpen(true);console.log(ENDPOINT);var sk=socketIOClient(ENDPOINT);setSocket(sk);};var submitHandler=function submitHandler(e){e.preventDefault();if(!messageBody.trim()){alert('Error. Please type message.');}else{setMessages([].concat(_toConsumableArray(messages),[{body:messageBody,name:userInfo.name}]));setMessageBody('');setTimeout(function(){socket.emit('onMessage',{body:messageBody,name:userInfo.name,isAdmin:userInfo.isAdmin,_id:userInfo._id});},1000);}};var closeHandler=function closeHandler(){setIsOpen(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"chatbox\",children:!isOpen?/*#__PURE__*/_jsx(Button,{variant:\"light\",type:\"button\",onClick:supportHandler,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-life-ring\"})}):/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(Row,{className:\"justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Support \"})}),/*#__PURE__*/_jsx(Col,{className:\"text-end\",children:/*#__PURE__*/_jsx(Button,{variant:\"light\",type:\"button\",onClick:closeHandler,children:/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-times-circle\"})})})]}),/*#__PURE__*/_jsx(\"ul\",{ref:uiMessagesRef,children:messages.map(function(msg,index){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\".concat(msg.name,\": \")}),\" \",msg.body]},index);})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"form\",{onSubmit:submitHandler,children:/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsx(FormControl,{type:\"text\",id:\"q\",value:messageBody,onChange:function onChange(e){return setMessageBody(e.target.value);},required:true}),/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",type:\"submit\",id:\"button-search\",children:\"Send\"})]})})})]})})});}","map":{"version":3,"sources":["/home/carlos/Documents/GitHub/mern-ecommerce/frontend/src/components/ChatBox.js"],"names":["React","useEffect","useRef","useState","socketIOClient","Row","Col","Card","Button","InputGroup","FormControl","ENDPOINT","window","location","host","indexOf","ChatBox","props","userInfo","socket","setSocket","uiMessagesRef","isOpen","setIsOpen","messageBody","setMessageBody","name","body","messages","setMessages","current","scrollBy","top","clientHeight","left","behavior","emit","_id","isAdmin","on","data","supportHandler","console","log","sk","submitHandler","e","preventDefault","trim","alert","setTimeout","closeHandler","map","msg","index","target","value"],"mappings":"8RAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,MAA3B,CAAmCC,QAAnC,KAAmD,OAAnD,CACA,MAAOC,CAAAA,cAAP,KAA2B,kBAA3B,CACA,MAAOC,CAAAA,GAAP,KAAgB,qBAAhB,CACA,MAAOC,CAAAA,GAAP,KAAgB,qBAAhB,CACA,MAAOC,CAAAA,IAAP,KAAiB,sBAAjB,CACA,MAAOC,CAAAA,MAAP,KAAmB,wBAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,4BAAvB,CACA,MAAOC,CAAAA,WAAP,KAAwB,6BAAxB,C,wFAEA,GAAMC,CAAAA,QAAQ,CACZC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,OAArB,CAA6B,WAA7B,GAA6C,CAA7C,CACI,uBADJ,CAEIH,MAAM,CAACC,QAAP,CAAgBC,IAHtB,CAKA,cAAe,SAASE,CAAAA,OAAT,CAAiBC,KAAjB,CAAwB,CACrC,GAAQC,CAAAA,QAAR,CAAqBD,KAArB,CAAQC,QAAR,CACA,cAA4Bf,QAAQ,CAAC,IAAD,CAApC,wCAAOgB,MAAP,eAAeC,SAAf,eACA,GAAMC,CAAAA,aAAa,CAAGnB,MAAM,CAAC,IAAD,CAA5B,CACA,eAA4BC,QAAQ,CAAC,KAAD,CAApC,yCAAOmB,MAAP,eAAeC,SAAf,eACA,eAAsCpB,QAAQ,CAAC,EAAD,CAA9C,yCAAOqB,WAAP,eAAoBC,cAApB,eACA,eAAgCtB,QAAQ,CAAC,CACvC,CAAEuB,IAAI,CAAE,OAAR,CAAiBC,IAAI,CAAE,wCAAvB,CADuC,CAAD,CAAxC,yCAAOC,QAAP,eAAiBC,WAAjB,eAIA5B,SAAS,CAAC,UAAM,CACd,GAAIoB,aAAa,CAACS,OAAlB,CAA2B,CACzBT,aAAa,CAACS,OAAd,CAAsBC,QAAtB,CAA+B,CAC7BC,GAAG,CAAEX,aAAa,CAACS,OAAd,CAAsBG,YADE,CAE7BC,IAAI,CAAE,CAFuB,CAG7BC,QAAQ,CAAE,QAHmB,CAA/B,EAKD,CACD,GAAIhB,MAAJ,CAAY,CACVA,MAAM,CAACiB,IAAP,CAAY,SAAZ,CAAuB,CACrBC,GAAG,CAAEnB,QAAQ,CAACmB,GADO,CAErBX,IAAI,CAAER,QAAQ,CAACQ,IAFM,CAGrBY,OAAO,CAAEpB,QAAQ,CAACoB,OAHG,CAAvB,EAKAnB,MAAM,CAACoB,EAAP,CAAU,SAAV,CAAqB,SAACC,IAAD,CAAU,CAC7BX,WAAW,8BAAKD,QAAL,GAAe,CAAED,IAAI,CAAEa,IAAI,CAACb,IAAb,CAAmBD,IAAI,CAAEc,IAAI,CAACd,IAA9B,CAAf,GAAX,CACD,CAFD,EAGD,CACF,CAlBQ,CAkBN,CAACE,QAAD,CAAWN,MAAX,CAAmBH,MAAnB,CAA2BD,QAA3B,CAlBM,CAAT,CAoBA,GAAMuB,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAC3BlB,SAAS,CAAC,IAAD,CAAT,CACAmB,OAAO,CAACC,GAAR,CAAYhC,QAAZ,EACA,GAAMiC,CAAAA,EAAE,CAAGxC,cAAc,CAACO,QAAD,CAAzB,CACAS,SAAS,CAACwB,EAAD,CAAT,CACD,CALD,CAMA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,CAAD,CAAO,CAC3BA,CAAC,CAACC,cAAF,GACA,GAAI,CAACvB,WAAW,CAACwB,IAAZ,EAAL,CAAyB,CACvBC,KAAK,CAAC,6BAAD,CAAL,CACD,CAFD,IAEO,CACLpB,WAAW,8BAAKD,QAAL,GAAe,CAAED,IAAI,CAAEH,WAAR,CAAqBE,IAAI,CAAER,QAAQ,CAACQ,IAApC,CAAf,GAAX,CACAD,cAAc,CAAC,EAAD,CAAd,CACAyB,UAAU,CAAC,UAAM,CACf/B,MAAM,CAACiB,IAAP,CAAY,WAAZ,CAAyB,CACvBT,IAAI,CAAEH,WADiB,CAEvBE,IAAI,CAAER,QAAQ,CAACQ,IAFQ,CAGvBY,OAAO,CAAEpB,QAAQ,CAACoB,OAHK,CAIvBD,GAAG,CAAEnB,QAAQ,CAACmB,GAJS,CAAzB,EAMD,CAPS,CAOP,IAPO,CAAV,CAQD,CACF,CAhBD,CAiBA,GAAMc,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzB5B,SAAS,CAAC,KAAD,CAAT,CACD,CAFD,CAGA,mBACE,YAAK,SAAS,CAAC,SAAf,UACG,CAACD,MAAD,cACC,KAAC,MAAD,EAAQ,OAAO,CAAC,OAAhB,CAAwB,IAAI,CAAC,QAA7B,CAAsC,OAAO,CAAEmB,cAA/C,uBACE,UAAG,SAAS,CAAC,kBAAb,EADF,EADD,cAKC,KAAC,IAAD,wBACE,MAAC,IAAD,CAAM,IAAN,yBACE,MAAC,GAAD,EAAK,SAAS,CAAC,4CAAf,wBACE,KAAC,GAAD,wBACE,oCADF,EADF,cAIE,KAAC,GAAD,EAAK,SAAS,CAAC,UAAf,uBACE,KAAC,MAAD,EAAQ,OAAO,CAAC,OAAhB,CAAwB,IAAI,CAAC,QAA7B,CAAsC,OAAO,CAAEU,YAA/C,uBACE,UAAG,KAAK,CAAC,qBAAT,EADF,EADF,EAJF,GADF,cAWE,WAAI,GAAG,CAAE9B,aAAT,UACGO,QAAQ,CAACwB,GAAT,CAAa,SAACC,GAAD,CAAMC,KAAN,qBACZ,mCACE,kCAAYD,GAAG,CAAC3B,IAAhB,QADF,KACsC2B,GAAG,CAAC1B,IAD1C,GAAS2B,KAAT,CADY,EAAb,CADH,EAXF,cAkBE,kCACE,aAAM,QAAQ,CAAET,aAAhB,uBACE,MAAC,UAAD,yBACE,KAAC,WAAD,EACE,IAAI,CAAC,MADP,CAEE,EAAE,CAAC,GAFL,CAGE,KAAK,CAAErB,WAHT,CAIE,QAAQ,CAAE,kBAACsB,CAAD,QAAOrB,CAAAA,cAAc,CAACqB,CAAC,CAACS,MAAF,CAASC,KAAV,CAArB,EAJZ,CAKE,QAAQ,KALV,EADF,cAQE,KAAC,MAAD,EACE,OAAO,CAAC,iBADV,CAEE,IAAI,CAAC,QAFP,CAGE,EAAE,CAAC,eAHL,kBARF,GADF,EADF,EAlBF,GADF,EANJ,EADF,CAmDD","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport socketIOClient from 'socket.io-client';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport FormControl from 'react-bootstrap/FormControl';\n\nconst ENDPOINT =\n  window.location.host.indexOf('localhost') >= 0\n    ? 'http://127.0.0.1:5000'\n    : window.location.host;\n\nexport default function ChatBox(props) {\n  const { userInfo } = props;\n  const [socket, setSocket] = useState(null);\n  const uiMessagesRef = useRef(null);\n  const [isOpen, setIsOpen] = useState(false);\n  const [messageBody, setMessageBody] = useState('');\n  const [messages, setMessages] = useState([\n    { name: 'Admin', body: 'Hello there, Please ask your question.' },\n  ]);\n\n  useEffect(() => {\n    if (uiMessagesRef.current) {\n      uiMessagesRef.current.scrollBy({\n        top: uiMessagesRef.current.clientHeight,\n        left: 0,\n        behavior: 'smooth',\n      });\n    }\n    if (socket) {\n      socket.emit('onLogin', {\n        _id: userInfo._id,\n        name: userInfo.name,\n        isAdmin: userInfo.isAdmin,\n      });\n      socket.on('message', (data) => {\n        setMessages([...messages, { body: data.body, name: data.name }]);\n      });\n    }\n  }, [messages, isOpen, socket, userInfo]);\n\n  const supportHandler = () => {\n    setIsOpen(true);\n    console.log(ENDPOINT);\n    const sk = socketIOClient(ENDPOINT);\n    setSocket(sk);\n  };\n  const submitHandler = (e) => {\n    e.preventDefault();\n    if (!messageBody.trim()) {\n      alert('Error. Please type message.');\n    } else {\n      setMessages([...messages, { body: messageBody, name: userInfo.name }]);\n      setMessageBody('');\n      setTimeout(() => {\n        socket.emit('onMessage', {\n          body: messageBody,\n          name: userInfo.name,\n          isAdmin: userInfo.isAdmin,\n          _id: userInfo._id,\n        });\n      }, 1000);\n    }\n  };\n  const closeHandler = () => {\n    setIsOpen(false);\n  };\n  return (\n    <div className=\"chatbox\">\n      {!isOpen ? (\n        <Button variant=\"light\" type=\"button\" onClick={supportHandler}>\n          <i className=\"fas fa-life-ring\" />\n        </Button>\n      ) : (\n        <Card>\n          <Card.Body>\n            <Row className=\"justify-content-between align-items-center\">\n              <Col>\n                <strong>Support </strong>\n              </Col>\n              <Col className=\"text-end\">\n                <Button variant=\"light\" type=\"button\" onClick={closeHandler}>\n                  <i class=\"fas fa-times-circle\"></i>\n                </Button>\n              </Col>\n            </Row>\n            <ul ref={uiMessagesRef}>\n              {messages.map((msg, index) => (\n                <li key={index}>\n                  <strong>{`${msg.name}: `}</strong> {msg.body}\n                </li>\n              ))}\n            </ul>\n            <div>\n              <form onSubmit={submitHandler}>\n                <InputGroup>\n                  <FormControl\n                    type=\"text\"\n                    id=\"q\"\n                    value={messageBody}\n                    onChange={(e) => setMessageBody(e.target.value)}\n                    required\n                  />\n                  <Button\n                    variant=\"outline-primary\"\n                    type=\"submit\"\n                    id=\"button-search\"\n                  >\n                    Send\n                  </Button>\n                </InputGroup>\n              </form>\n            </div>\n          </Card.Body>\n        </Card>\n      )}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}